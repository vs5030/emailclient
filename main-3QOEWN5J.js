import{$ as j,A,B as q,D as E,E as _,F as p,I as H,K as x,L as J,N as W,O as K,P as Q,Q as X,S as Y,T as b,U as Z,V as tt,W as I,X as l,Z as u,_ as M,aa as C,ba as N,c as U,ca as T,d as F,da as et,e as R,ea as L,f as G,fa as it,g as B,h as $,j as h,k as g,n as w,o as v,p as V,q as z,t as s,u as c,v as S,w as m,x as o,y as a,z as y}from"./chunk-XN6PGMB5.js";var rt=(e,t)=>{let f=new b;return z(l).signedin$.pipe(B(i=>i===null),F(i=>i),G(1),$(i=>{i||f.navigateByUrl("/")}))};var ht=[{path:"inbox",canMatch:[rt],loadChildren:()=>import("./chunk-MUWTN3MR.js").then(e=>e.InboxModule)}],nt=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=g({type:t}),t.\u0275inj=v({imports:[I.forRoot(ht),I]});let e=t;return e})();function gt(e,t){e&1&&(A(0),o(1,"a",5),p(2,"Inbox"),a(),o(3,"a",6),p(4,"Sign Out"),a(),q())}var vt=()=>({exact:!0});function St(e,t){e&1&&(A(0),o(1,"a",7),p(2,"Sign In"),a(),o(3,"a",8),p(4,"Sign Up"),a(),q()),e&2&&(s(),m("routerLinkActiveOptions",H(1,vt)))}var at=(()=>{let t=class t{constructor(i){this.authService=i,this.signedin=null}ngOnInit(){this.authService.signedin$.subscribe(i=>{this.signedin=i}),this.authService.checkSignedIn().subscribe(()=>{})}};t.\u0275fac=function(r){return new(r||t)(c(l))},t.\u0275cmp=h({type:t,selectors:[["app-root"]],decls:8,vars:2,consts:[[1,"ui","container"],[1,"ui","secondary","pointing","menu"],["routerLink","/inbox",1,"item"],[1,"right","menu"],[4,"ngIf"],["routerLink","/inbox","routerLinkActive","active",1,"ui","item"],["routerLink","/signout","routerLinkActive","active",1,"ui","item"],["routerLink","/","routerLinkActive","active",1,"ui","item",3,"routerLinkActiveOptions"],["routerLink","/signup","routerLinkActive","active",1,"ui","item"]],template:function(r,n){r&1&&(o(0,"div",0)(1,"div",1)(2,"a",2),p(3,"Angular Email"),a(),o(4,"div",3),S(5,gt,5,0,"ng-container",4)(6,St,5,2,"ng-container",4),a()(),y(7,"router-outlet"),a()),r&2&&(s(5),m("ngIf",n.signedin),s(),m("ngIf",!n.signedin))},dependencies:[x,Y,Z,tt]});let e=t;return e})();function Ct(e,t){e&1&&(o(0,"p"),p(1," Incorrect Username and/or Password. Please try again. "),a())}function wt(e,t){e&1&&(o(0,"p"),p(1," Unable to sign in. Please try again later. "),a())}function xt(e,t){if(e&1&&(o(0,"div",5),S(1,Ct,2,0,"p",6)(2,wt,2,0,"p",6),a()),e&2){let f=_();s(),m("ngIf",f.authForm.errors.invalidCredentialsEntered),s(),m("ngIf",f.authForm.errors.unknownError)}}var D=(()=>{let t=class t{constructor(i,r){this.authService=i,this.router=r,this.authForm=new j({username:new C("",[u.required,u.minLength(3),u.maxLength(20),u.pattern(/^[0-9a-z]+$/)]),password:new C("",[u.required,u.minLength(4),u.maxLength(20)])})}onSubmit(){this.authForm.invalid||this.authService.signin(this.authForm.value).subscribe({next:()=>{this.router.navigateByUrl("/inbox")},error:({error:i})=>{this.authService.signedin$.next(!1),i.username||i.password?this.authForm.setErrors({invalidCredentialsEntered:!0}):this.authForm.setErrors({unknownError:!0})}})}};t.\u0275fac=function(r){return new(r||t)(c(l),c(b))},t.\u0275cmp=h({type:t,selectors:[["app-signin"]],decls:9,vars:5,consts:[[1,"ui","form",3,"formGroup","ngSubmit"],["label","Username","inputType","text",3,"control"],["label","Password","inputType","password",3,"control"],["class","ui red basic label",4,"ngIf"],[1,"ui","submit","button","primary",3,"disabled"],[1,"ui","red","basic","label"],[4,"ngIf"]],template:function(r,n){r&1&&(o(0,"h3"),p(1,"Sign in"),a(),o(2,"form",0),E("ngSubmit",function(){return n.onSubmit()}),y(3,"app-input",1)(4,"app-input",2),S(5,xt,3,2,"div",3),o(6,"div")(7,"button",4),p(8,"Submit"),a()()()),r&2&&(s(2),m("formGroup",n.authForm),s(),m("control",n.authForm.controls.username),s(),m("control",n.authForm.controls.password),s(),m("ngIf",n.authForm.errors),s(2),m("disabled",n.authForm.invalid))},dependencies:[x,N,M,T,L],styles:[".basic.label[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{margin-bottom:.5em}"]});let e=t;return e})();var st=(()=>{let t=class t{validate(i){return i.get("password")?.value===i.get("passwordConfirmation")?.value?null:{passwordDoesNotMatch:!0}}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=w({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var mt=(()=>{let t=class t{constructor(i){this.authService=i,this.validate=r=>this.authService.usernameAvailable(r.value).pipe(F(n=>n.available?null:{nonUniqueUser:!0}),R(n=>n.error.username?U({nonUniqueUser:!0}):U({connectionError:!0})))}};t.\u0275fac=function(r){return new(r||t)(V(l))},t.\u0275prov=w({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function Et(e,t){e&1&&(o(0,"p"),p(1," Password and Password Confirmation must match. "),a())}function _t(e,t){e&1&&(o(0,"p"),p(1," There is a connection error. Please try again later. "),a())}function Mt(e,t){e&1&&(o(0,"p"),p(1," Unable to complete request. Please try again later. "),a())}function jt(e,t){if(e&1&&(o(0,"div",6),S(1,Et,2,0,"p",7)(2,_t,2,0,"p",7)(3,Mt,2,0,"p",7),a()),e&2){let f=_();s(),m("ngIf",f.authForm.errors.passwordDoesNotMatch),s(),m("ngIf",f.authForm.errors.connectionError),s(),m("ngIf",f.authForm.errors.requestNotSuccessful)}}var pt=(()=>{let t=class t{onSubmit(){this.authForm.invalid||(console.log("form submitted."),this.authService.signupUser(this.authForm.value).subscribe({next:()=>{this.router.navigateByUrl("/inbox")},error:i=>{console.error("Observable emitted an error: "+JSON.stringify(i)),i.status===0?this.authForm.setErrors({connectionError:!0}):this.authForm.setErrors({requestNotSuccessful:!0})}}))}constructor(i,r,n,P){this.matchPassword=i,this.uniqueUser=r,this.authService=n,this.router=P,this.authForm=new j({username:new C("",[u.required,u.minLength(3),u.maxLength(20),u.pattern(/^[a-z0-9]+$/)],[this.uniqueUser.validate]),password:new C("",[u.required,u.minLength(4),u.maxLength(20)]),passwordConfirmation:new C("",[u.required,u.minLength(4),u.maxLength(20)])},{validators:[this.matchPassword.validate]})}};t.\u0275fac=function(r){return new(r||t)(c(st),c(mt),c(l),c(b))},t.\u0275cmp=h({type:t,selectors:[["app-signup"]],decls:11,vars:6,consts:[[1,"ui","form",3,"formGroup","ngSubmit"],["inputType","text","label","Username",3,"control"],["inputType","password","label","Password",3,"control"],["inputType","password","label","Password Confirmation",3,"control"],["class","ui red basic label",4,"ngIf"],[1,"ui","submit","button","primary",3,"disabled"],[1,"ui","red","basic","label"],[4,"ngIf"]],template:function(r,n){r&1&&(o(0,"h3"),p(1,"Create an Account"),a(),o(2,"form",0),E("ngSubmit",function(){return n.onSubmit()}),y(3,"app-input",1)(4,"app-input",2)(5,"app-input",3),S(6,jt,4,3,"div",4),o(7,"div")(8,"button",5),p(9,"Submit"),a()()(),y(10,"hr")),r&2&&(s(2),m("formGroup",n.authForm),s(),m("control",n.authForm.controls.username),s(),m("control",n.authForm.controls.password),s(),m("control",n.authForm.controls.passwordConfirmation),s(),m("ngIf",n.authForm.controls.password.touched&&n.authForm.controls.passwordConfirmation.touched&&n.authForm.errors),s(2),m("disabled",n.authForm.invalid))},dependencies:[x,N,M,T,L],styles:[".basic.label[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{margin-bottom:.5em}"]});let e=t;return e})();var ut=(()=>{let t=class t{constructor(i,r){this.authService=i,this.router=r}ngOnInit(){this.authService.signout().subscribe(()=>{console.log("user has signed out"),this.router.navigateByUrl("/")})}};t.\u0275fac=function(r){return new(r||t)(c(l),c(b))},t.\u0275cmp=h({type:t,selectors:[["app-signout"]],decls:2,vars:0,template:function(r,n){r&1&&(o(0,"p"),p(1,"Signing out..."),a())}});let e=t;return e})();var Nt=[{path:"",component:D},{path:"inbox",component:D},{path:"signup",component:pt},{path:"signout",component:ut}],ct=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=g({type:t}),t.\u0275inj=v({imports:[I.forChild(Nt),I]});let e=t;return e})();var lt=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=g({type:t}),t.\u0275inj=v({imports:[J,ct,et,it]});let e=t;return e})();var dt=(()=>{let t=class t{intercept(i,r){let n=i.clone({withCredentials:!0});return r.handle(n)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=w({token:t,factory:t.\u0275fac});let e=t;return e})();var ft=(()=>{let t=class t{};t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=g({type:t,bootstrap:[at]}),t.\u0275inj=v({providers:[{provide:W,useClass:dt,multi:!0}],imports:[X,nt,lt,K]});let e=t;return e})();Q().bootstrapModule(ft).catch(e=>console.error(e));
